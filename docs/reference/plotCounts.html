<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot counts — plotCounts • pointillism</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Plot counts — plotCounts" />
<meta property="og:description" content="Visualize genes on a dot or violin plot." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pointillism</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../articles/pointillism.html">Get started</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://acidgenomics.com/">
    <span class="fas fa fas fa-vial fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/acidgenomics/pointillism/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot counts</h1>
    <small class="dont-index">Source: <a href='https://github.com/acidgenomics/pointillism/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/acidgenomics/pointillism/blob/master/R/plotCounts-methods.R'><code>R/plotCounts-methods.R</code></a>, <a href='https://github.com/acidgenomics/pointillism/blob/master/R/plotDots-methods.R'><code>R/plotDots-methods.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>plotCounts.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Visualize genes on a dot or violin plot.</p>
    </div>

    <pre class="usage"><span class='fu'>plotCounts</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>plotDots</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>plotViolin</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for SingleCellExperiment</span>
<span class='fu'>plotCounts</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>genes</span>,
  assay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"logcounts"</span>, <span class='st'>"normcounts"</span><span class='op'>)</span>,
  geom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"violin"</span>, <span class='st'>"dot"</span><span class='op'>)</span>,
  perSample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.legend"</span>, default <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for Seurat</span>
<span class='fu'>plotCounts</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>genes</span>,
  assay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"logcounts"</span>, <span class='st'>"normcounts"</span><span class='op'>)</span>,
  geom <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"violin"</span>, <span class='st'>"dot"</span><span class='op'>)</span>,
  perSample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.legend"</span>, default <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for SingleCellExperiment</span>
<span class='fu'>plotDots</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>genes</span>,
  perSample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  colMin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2.5</span>,
  colMax <span class='op'>=</span> <span class='fl'>2.5</span>,
  dotMin <span class='op'>=</span> <span class='fl'>0L</span>,
  dotScale <span class='op'>=</span> <span class='fl'>6L</span>,
  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.continuous.color"</span>, default <span class='op'>=</span>
    <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_color_gradient2</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"orange"</span>, mid <span class='op'>=</span> <span class='st'>"gray75"</span>, high <span class='op'>=</span> <span class='st'>"purple"</span>,
    midpoint <span class='op'>=</span> <span class='fl'>0L</span><span class='op'>)</span><span class='op'>)</span>,
  legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.legend"</span>, default <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for Seurat</span>
<span class='fu'>plotDots</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>genes</span>,
  perSample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  colMin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2.5</span>,
  colMax <span class='op'>=</span> <span class='fl'>2.5</span>,
  dotMin <span class='op'>=</span> <span class='fl'>0L</span>,
  dotScale <span class='op'>=</span> <span class='fl'>6L</span>,
  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.continuous.color"</span>, default <span class='op'>=</span>
    <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_color_gradient2</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"orange"</span>, mid <span class='op'>=</span> <span class='st'>"gray75"</span>, high <span class='op'>=</span> <span class='st'>"purple"</span>,
    midpoint <span class='op'>=</span> <span class='fl'>0L</span><span class='op'>)</span><span class='op'>)</span>,
  legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.legend"</span>, default <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for SingleCellExperiment</span>
<span class='fu'>plotViolin</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>genes</span>,
  assay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"logcounts"</span>, <span class='st'>"normcounts"</span><span class='op'>)</span>,
  perSample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  scale <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"count"</span>, <span class='st'>"width"</span>, <span class='st'>"area"</span><span class='op'>)</span>,
  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.discrete.color"</span>, default <span class='op'>=</span>
    <span class='fu'>AcidPlots</span><span class='fu'>::</span><span class='fu'><a href='https://acidplots.acidgenomics.com/reference/synesthesia.html'>scale_color_synesthesia_d</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
  legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.legend"</span>, default <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for Seurat</span>
<span class='fu'>plotViolin</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>genes</span>,
  assay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"logcounts"</span>, <span class='st'>"normcounts"</span><span class='op'>)</span>,
  perSample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  scale <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"count"</span>, <span class='st'>"width"</span>, <span class='st'>"area"</span><span class='op'>)</span>,
  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.discrete.color"</span>, default <span class='op'>=</span>
    <span class='fu'>AcidPlots</span><span class='fu'>::</span><span class='fu'><a href='https://acidplots.acidgenomics.com/reference/synesthesia.html'>scale_color_synesthesia_d</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
  legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"acid.legend"</span>, default <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Object.</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p><code>character</code>.
Gene identifiers.</p></td>
    </tr>
    <tr>
      <th>assay</th>
      <td><p><code><a href='https://rdrr.io/r/base/vector.html'>vector(1)</a></code>.
Assay name or index position.</p></td>
    </tr>
    <tr>
      <th>geom</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>.
Plot type. Uses <code><a href='https://rdrr.io/r/base/match.arg.html'>match.arg()</a></code> to pick the type.
Currently supports <code>"dot"</code> and <code>"violin"</code>.</p></td>
    </tr>
    <tr>
      <th>perSample</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code>.
Visualize the distributions per sample.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code>.
Include plot legend.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>.
Title.</p></td>
    </tr>
    <tr>
      <th>colMin</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>.
Minimum scaled average expression threshold. Everything smaller will be
set to this.</p></td>
    </tr>
    <tr>
      <th>colMax</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>.
Maximum scaled average expression threshold. Everything larger will be set
to this.</p></td>
    </tr>
    <tr>
      <th>dotMin</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>.
The fraction of cells at which to draw the smallest dot. All cell groups
with less than this expressing the given gene will have no dot drawn.</p></td>
    </tr>
    <tr>
      <th>dotScale</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>.
Scale the size of the points, similar to <code>cex</code>.</p></td>
    </tr>
    <tr>
      <th>color</th>
      <td><p><code>ScaleDiscrete</code>.
Desired ggplot2 color scale. Must supply discrete values. When set <code>NULL</code>,
the default ggplot2 color palette will be used. If manual color definitions
are desired, we recommend using <code><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>ggplot2::scale_color_manual()</a></code>.</p>
<p>To set the discrete color palette globally, use:</p><pre><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>acid.color.discrete <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_color_viridis_d</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</pre></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>.
If "area" (default), all violins have the same area (before trimming the
tails). If "count", areas are scaled proportionally to the number of
observartions. If "width", all violins have the same maximum width.
See <code><a href='https://ggplot2.tidyverse.org/reference/geom_violin.html'>ggplot2::geom_violin</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>ggplot</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Dot geom currently only supports logcounts.</p>
<p>Updated 2020-10-12.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p><code><a href='https://rdrr.io/pkg/Seurat/man/DotPlot.html'>Seurat::DotPlot()</a></code>.</p></li>
<li><p><code><a href='https://rdrr.io/pkg/Seurat/man/VlnPlot.html'>Seurat::VlnPlot()</a></code>.</p></li>
<li><p><code><a href='https://rdrr.io/pkg/Seurat/man/RidgePlot.html'>Seurat::RidgePlot()</a></code>.</p></li>
<li><p><code><a href='https://rdrr.io/pkg/monocle3/man/plot_genes_violin.html'>monocle3::plot_genes_violin()</a></code>.</p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Seurat</span>, package <span class='op'>=</span> <span class='st'>"AcidTest"</span><span class='op'>)</span>

<span class='co'>## Seurat ====</span>
<span class='va'>object</span> <span class='op'>&lt;-</span> <span class='va'>Seurat</span>

<span class='co'>## Plotting with either gene IDs or gene names (symbols) works.</span>
<span class='va'>genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>, n <span class='op'>=</span> <span class='fl'>4L</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>genes</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "MS4A1"   "CD79B"   "CD79A"   "HLA-DRA"</div><div class='input'>
<span class='co'>## Per sample mode enabled.</span>
<span class='fu'>plotCounts</span><span class='op'>(</span><span class='va'>object</span>, genes <span class='op'>=</span> <span class='va'>genes</span>, perSample <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='plotCounts-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Per sample mode disabled.</span>
<span class='fu'>plotCounts</span><span class='op'>(</span><span class='va'>object</span>, genes <span class='op'>=</span> <span class='va'>genes</span>, perSample <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='plotCounts-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://steinbaugh.com/'>Michael Steinbaugh</a>, <a href='https://acidgenomics.com/'>Acid Genomics</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


